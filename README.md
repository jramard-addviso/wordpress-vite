# Wordpress Vite

A library to properly integrate a Vite workflow into WordPress.

## Prerequisites

The npm module [vite-plugin-wordpress](https://github.com/jramard-addviso/vite-plugin-wordpress) is required for this library to work properly. Please ensure that it is installed before proceeding.

## How it works

All the logic for resolving paths to assets generated by Vite is located in the core of the library.

All you have to do is instantiate the module by passing two parameters:

1. the path to the `vite.config.php` configuration file generated by the previously installed `vite-plugin-wordpress` npm module;
2. the current Wordpress environment type (production or whatever else).

```php
use Juster\WordpressVite\App;

function vite(): App
{
    return App::get(ABSPATH, WP_ENVIRONMENT_TYPE);
}

vite();
```

You may need an [autoloader](https://www.php.net/manual/en/language.oop5.autoload.php) for this. [Composer](https://getcomposer.org/doc/01-basic-usage.md#autoloading) can help you with that.

Then, you can include your CSS & JavaScript files in this way:

```php
function theme(): void
{
    vite()->assets()->enqueueStyle('theme', 'src/styles/main.css');
    vite()->assets()->enqueueScript('theme', 'src/scripts/main.js');
}

add_action('wp_enqueue_scripts', 'theme');
```

For other static files that need to be included in templates, such as images, you can proceed as follows:

```html
<img
  src="<?= vite()->assets()->resolve('src/assets/images/placeholder.webp') ?>"
  alt="A wonderful image"
/>
```

And if you prefer to avoid this verbosity, you can declare a small utility function, such as this one, for example:

```php
function asset($path): string
{
    return vite()->assets()->resolve("src/assets/$path");
}
```

This results in the following in the templates:

```html
<img src="<?= asset('images/placeholder.webp') ?>" alt="A wonderful image" />
```
